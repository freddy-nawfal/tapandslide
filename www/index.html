<!DOCTYPE html>
<html>
 
    <head>
        <meta charset="utf-8">
        <script src="js/phaser.js"></script>
        <link rel="stylesheet" href="css/main.css" type="text/css">
    </head>
 
    <body ng-app="main">
    	<div id="menu">
    		MAIN MENU

			<button onclick="playRanked()">Ranked</button>
            <button onclick="playPractice()">Practice</button>
    	</div>
    	<div id="msg"></div>
		<div id="game"></div>


		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="js/socket.io.js"></script>
		<script src="cordova.js"></script>
		<script type="text/javascript" src="js/utilities.js"></script>
		<script src="js/game.js"></script>
    	<script type="text/javascript">
    		
    		document.addEventListener('deviceready', Startup, false);

    		var socket;

    		function Startup(){
				// INIT SOCKET
				socket = io.connect('http://localhost:8000');

				$("#game").hide();
    		}

            function mainMenu(){
                $("#menu").show();
                $("#game").hide();
            }

    		function playRanked(){
    			$("#menu").hide();

    			socket.emit("search", "ranked");
    			$("#msg").html("Searching for an opponent...");

                var level = [];

                socket.on('level', function(data){
                    level = data;
                });

                socket.on("joinedRoom", function(data){
                    $("#msg").html("Game found");

                    if(game)game.destroy();

                    launch("ranked",level);
                    setTimeout(function(){
                        $("#msg").html("");
                        $("#game").slideToggle("slow");
                    }, 1000);
                });

                socket.on('opponentLeft', function(){
                	mainMenu();
                });
    		}

            function playPractice(){
                $("#menu").hide();

                var level = generatePracticeLevel(50);
                $("#msg").html("Generating practice level...");

                if(game)game.destroy();

                launch("practice",level);
                setTimeout(function(){
                    $("#msg").html("");
                    $("#game").slideToggle("slow");
                }, 1000);
            }

    	</script>

        
    </body>
 
</html>